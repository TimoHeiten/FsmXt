class State
{
    string name;
    Dictionary<string, Action<Message>> events;
    Action Error;
}

class Message
{
	string EventName;
	gethashcode();
	
}

var transactions = new Dictionary<string, State>
{
	["incoming"] = new State(name = "start", () => cw("started"));
}	

findState(string type, Message msg, onError = null)
{
	string eventName = msg.EventName;
	if (transaction.TryGetValue(type, out State state))
	{
		if (state.events.TryGetValue(msg.EventName, out Action act))
		{
			act(msg);
		}
		else
			onError();
	}
	else
	{
		var error = onError ?? () => cw
		error.handle();
	}
}